<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Thư cho Nguyễn Văn Thiện ❤️</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;600&display=swap');
  :root{
    --bg:#0f0c12;
    --panel:#1b1720;
    --accent:#ff6b81;
    --text:#f5f5f7;
    --muted:#cfc9d6;
  }
  html,body{height:100%;margin:0;background: radial-gradient(ellipse at top left, rgba(255,107,129,0.06), transparent 20%), linear-gradient(180deg,#0b0910 0%, #0f0c12 100%);font-family:Quicksand,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;}
  .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:24px;box-sizing:border-box;}
  .card{width:100%;max-width:820px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:16px;padding:34px;box-shadow:0 10px 30px rgba(2,2,6,0.6);position:relative;overflow:hidden;border:1px solid rgba(255,255,255,0.03);}
  .header{display:flex;align-items:center;gap:14px;margin-bottom:18px;}
  .avatar{width:56px;height:56px;border-radius:50%;background:linear-gradient(135deg,#3b2b73,#ff6b81);display:flex;align-items:center;justify-content:center;color:white;font-weight:600;font-size:20px;box-shadow:0 6px 18px rgba(0,0,0,0.5);}
  h1{color:var(--text);margin:0;font-size:20px;letter-spacing:0.2px}
  p.meta{margin:0;color:var(--muted);font-size:13px}
  .letter{color:var(--text);font-size:18px;line-height:1.6;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);padding:22px;border-radius:12px;margin-top:18px;border:1px solid rgba(255,255,255,0.02);}
  .sender{display:block;text-align:right;margin-top:18px;color:var(--muted);font-weight:600}
  .controls{position:absolute;right:18px;top:18px;display:flex;gap:8px;align-items:center}
  .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:10px;color:var(--muted);cursor:pointer;font-weight:600}
  .heart-layer{position:absolute;inset:0;pointer-events:none;overflow:hidden}
  .heart{position:absolute;width:28px;height:28px;transform:translate(-50%,-50%) rotate(-45deg);opacity:0.9}
  .heart:before,.heart:after{content:"";position:absolute;width:28px;height:28px;background:radial-gradient(circle at 30% 30%, #fff8, transparent 30%),linear-gradient(180deg,#ff8aa0,#ff5b82);border-radius:50%}
  .heart:before{left:50%;top:0;transform:translate(-50%,-50%);}
  .heart:after{top:50%;left:0;transform:translate(-50%,-50%);}
  .note{font-style:italic;color:var(--muted);margin-top:12px;font-size:14px}
  footer{margin-top:20px;color:rgba(255,255,255,0.06);font-size:12px;text-align:center}
  /* responsive */
  @media (max-width:520px){.card{padding:20px}.letter{font-size:16px}}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" role="main" aria-labelledby="title">
    <div class="controls" aria-hidden="true">
      <button id="playBtn" class="btn">Play music ▶</button>
      <button id="pauseBtn" class="btn" style="display:none">Pause ⏸</button>
    </div>
    <div class="header">
      <div class="avatar">Vợ</div>
      <div>
        <h1 id="title">Gửi: Nguyễn Văn Thiện</h1>
        <p class="meta">Thư nhỏ gửi anh — mở lúc anh cần một chút ấm áp</p>
      </div>
    </div>

    <div class="letter" id="letter">
      <div style="font-size:15px;color:var(--muted);margin-bottom:10px">Chồng ơi,</div>

      <div style="white-space:pre-wrap;">
chồng ơi , chắc anh quên rồi , nhưng để e nói lại nha : em trước giờ trước mặt mọi người em luôn là con bé mạnh mẽ , không khóc lóc trước mặt bất kì ai , bố mẹ có đánh có chửi thì sau đấy em tự nhốt mình lại rồi mới khóc , nhưng yêu chồng em cảm nhận được chồng thương em , chồng cho em cảm giác an toàn và được mở lòng mình ra , nên nhiều khi lúc yếu đuối nhất em thể hiện ra sẽ luôn là khi được bên cạnh anh . Em biết anh còn nhiều áp lực khác , nên em đã luôn vui vẻ nhất gạt qua nhưng lúc nước mắt muốn rơi 
Em biết đời  bạc với anh  , anh rất áp lực nhưng em đâu có bạc với anh đâu :(( em thương anh nhiều lắm . Em cũng ko bt sao tự dưng bây giờ khi em khóc anh lại thấy em là cái đứa chỉ bt khóc thoi .....
      </div>

      <span class="sender">— Vợ</span>
      <div class="note">Mở nhạc (nút ▶) để nghe giai điệu piano nhẹ, hoặc nhấn tắt nếu cần riêng tư.</div>
    </div>

    <footer>Gửi em — giữ ấm cho anh.</footer>
    <div class="heart-layer" id="hearts" aria-hidden="true"></div>
  </div>
</div>

<script>
// Hearts animation
const heartLayer = document.getElementById('hearts');
const colors = ['#ff6b81','#ff9bb3','#ff5b82','#ffd1dc'];
function spawnHeart(){
  const h = document.createElement('div');
  h.className='heart';
  const size = 18 + Math.random()*32;
  h.style.width = h.style.height = size+'px';
  const left = Math.random()*100;
  const top = 60 + Math.random()*40;
  h.style.left = left + '%';
  h.style.top = (80 + Math.random()*20) + '%';
  h.style.opacity = 0.9 - Math.random()*0.4;
  h.style.transform = 'translate(-50%,-50%) rotate(-45deg) scale('+(0.7+Math.random()*1.3)+')';
  const col = colors[Math.floor(Math.random()*colors.length)];
  h.querySelectorAll?null:h.style.background=col;
  heartLayer.appendChild(h);
  const dx = (Math.random()*40-20);
  const dur = 6000 + Math.random()*7000;
  h.animate([
    { transform: `translate(-50%,-50%) translateY(0px) rotate(-45deg) scale(0.8)`, opacity:1 },
    { transform: `translate(-50%,-50%) translateY(-${200+Math.random()*220}px) rotate(-45deg) scale(1.1)`, opacity:0.06 }
  ],{duration:dur, easing:'ease-out'}).onfinish = ()=> h.remove();
}
// spawn periodically
setInterval(spawnHeart,700);

// Gentle synthesized piano-like pad using WebAudio API
let audioCtx, masterGain, isPlaying=false, seqTimer;
const playBtn = document.getElementById('playBtn');
const pauseBtn = document.getElementById('pauseBtn');

function setupAudio(){
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  masterGain = audioCtx.createGain();
  masterGain.gain.value = 0.0;
  masterGain.connect(audioCtx.destination);

  // ambient chord progression (piano-ish via FM-ish tones + noise)
  const notes = [
    [55, 69, 82], // A minor-ish
    [48, 60, 67], // C major-ish
    [50, 62, 69], // D minor-ish
    [52, 65, 77]  // E-ish
  ];

  let step=0;
  seqTimer = setInterval(()=>{
    playChord(notes[step%notes.length]);
    step++;
  }, 4200);
  // fade in
  masterGain.gain.cancelScheduledValues(audioCtx.currentTime);
  masterGain.gain.linearRampToValueAtTime(0.18, audioCtx.currentTime + 1.2);
  isPlaying=true;
}

function stopAudio(){
  if(!audioCtx) return;
  masterGain.gain.cancelScheduledValues(audioCtx.currentTime);
  masterGain.gain.linearRampToValueAtTime(0.0, audioCtx.currentTime + 0.8);
  clearInterval(seqTimer);
  isPlaying=false;
  // resume will create a new audio context on next play
  audioCtx = null;
}

// Play a warm "chord" by creating multiple oscillators with gentle envelopes
function playChord(freqs){
  if(!audioCtx) return;
  const now = audioCtx.currentTime;
  // create a subtle reverb using convolver could be heavy; we'll use simple feedback delay
  const chordGain = audioCtx.createGain();
  chordGain.gain.value = 0.0001;
  chordGain.connect(masterGain);

  freqs.forEach((f,i)=>{
    const osc = audioCtx.createOscillator();
    const osc2 = audioCtx.createOscillator();
    const g = audioCtx.createGain();
    const lp = audioCtx.createBiquadFilter();
    lp.type='lowpass'; lp.frequency.value = 1200 - i*120;
    osc.type='sine'; osc.frequency.value = f * (i===1?1.0: (i===2?0.5:1.0));
    osc2.type='triangle'; osc2.frequency.value = f * 0.997;
    const detuneGain = audioCtx.createGain();
    detuneGain.gain.value = 0.01;
    // mix
    osc.connect(g); osc2.connect(g);
    g.connect(lp); lp.connect(chordGain);
    // envelope
    g.gain.setValueAtTime(0.0001, now);
    g.gain.linearRampToValueAtTime(0.12/(i+1), now + 0.5 + Math.random()*0.4);
    g.gain.exponentialRampToValueAtTime(0.0001, now + 3.6 + Math.random()*1.6);
    osc.start(now);
    osc2.start(now);
    osc.stop(now + 4.2 + Math.random()*1.2);
    osc2.stop(now + 4.2 + Math.random()*1.2);
  });

  // small ambient noise burst for texture
  const bufferSize = 2 * audioCtx.sampleRate;
  const noiseBuffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
  const output = noiseBuffer.getChannelData(0);
  for (let i = 0; i < bufferSize; i++) output[i] = (Math.random()*2-1)*0.002;
  const noise = audioCtx.createBufferSource();
  noise.buffer = noiseBuffer;
  const noiseGain = audioCtx.createGain();
  noiseGain.gain.value = 0.0006;
  noise.connect(noiseGain); noiseGain.connect(chordGain);
  noise.start(now); noise.stop(now + 1.6);
}

// Play / Pause handlers
playBtn.addEventListener('click', async ()=>{
  if(!audioCtx){ try{ await (new Promise((res,rej)=>{ setTimeout(res,0); })); } catch(e){} setupAudio(); }
  if(audioCtx && audioCtx.state === 'suspended'){ await audioCtx.resume(); }
  playBtn.style.display='none'; pauseBtn.style.display='inline-block';
});
pauseBtn.addEventListener('click', ()=>{
  stopAudio();
  playBtn.style.display='inline-block'; pauseBtn.style.display='none';
});

// Accessibility: press space/enter to toggle when focused
playBtn.addEventListener('keydown',(e)=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); playBtn.click(); } });
pauseBtn.addEventListener('keydown',(e)=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); pauseBtn.click(); } });

// Small gentle entrance animation for letter
document.getElementById('letter').animate([
  { transform:'translateY(18px)', opacity:0 },
  { transform:'translateY(0px)', opacity:1 }
], { duration:700, easing:'cubic-bezier(.2,.9,.3,1)'});

</script>
</body>
</html>
